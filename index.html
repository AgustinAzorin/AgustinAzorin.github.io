<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tarjeta para Mel</title>
  <meta name="description" content="Tarjeta de cumpleaÃ±os virtual" />
  <style>
    :root{
      --bg: #0b0d10;
      --fg: #e8eef5;
      --muted:#9aa6b2;
      --accent:#8b5cf6;
      --paper:#11141a;
      --paper-in:#0f1724;
      --shadow: rgba(0,0,0,.35);
    }
    html.light{
      --bg:#f6f7fb;
      --fg:#0f172a;
      --muted:#5b6470;
      --accent:#7c3aed;
      --paper:#ffffff;
      --paper-in:#f8fafc;
      --shadow: rgba(0,0,0,.12);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 800px at 50% -10%, rgba(139,92,246,.15), transparent 60%), var(--bg);
      color: var(--fg); min-height:100svh; display:flex; align-items:center; justify-content:center;
    }
    .app{width:min(1100px, 100%); padding:24px}
    .topbar{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:18px}
    .topbar h1{font-size:16px; font-weight:600; letter-spacing:.3px; margin:0; color:var(--muted)}
    .btn{
      appearance:none; border:0; border-radius:14px; padding:10px 14px; font-weight:600; cursor:pointer;
      background:var(--paper); color:var(--fg); box-shadow: 0 6px 16px var(--shadow); transition:.2s transform,.2s filter,.2s background;
    }
    .btn:hover{transform:translateY(-1px)}
    .btn.primary{background:linear-gradient(135deg, var(--accent), #5b21b6); color:white}

    /* Escena y tarjeta */
    .scene{perspective: 1400px; display:grid; place-items:center}
    .greeting-card{
      width:min(780px, 94%); height: clamp(420px, 60svh, 560px);
      position:relative; transform-style: preserve-3d;
    }
    .cover, .inside{
      position:absolute; inset:0; border-radius:22px; box-shadow: 0 24px 60px var(--shadow);
      backface-visibility: hidden;
    }

    .cover{
      z-index:2;
      background:
        radial-gradient(900px 500px at 10% -20%, rgba(139,92,246,.25), transparent 60%),
        linear-gradient(165deg, #0b1020, var(--paper));
      transform-origin: left center;
      transform: rotateY(0deg);
      transition: transform 900ms cubic-bezier(.22,1,.36,1);
      display:flex; align-items:center; justify-content:center; padding:24px; cursor:pointer;
    }
    .cover h2{font-size: clamp(28px, 5vw, 46px); margin:0}
    .cover p{margin:6px 0 0; color:#d6d9e0}

    .inside{
      z-index:1;
      background: linear-gradient(180deg, var(--paper-in), var(--paper));
      padding:24px; display:flex; flex-direction:column; justify-content:space-between;
    }
    .message{
      background:rgba(0,0,0,.05); border:1px solid rgba(255,255,255,.06); border-radius:18px; padding:18px;
      margin-bottom:20px;
    }
    html.light .message{background:rgba(0,0,0,.03); border:1px solid rgba(0,0,0,.06)}
    .message h3{margin:0 0 8px; font-size: clamp(20px, 3.4vw, 26px)}
    .message p{margin:0; line-height:1.6; color:var(--fg)}

    /* GalerÃ­a */
    .gallery{border-radius:18px; overflow:hidden; background:rgba(0,0,0,.06);}
    .viewport{position:relative; overflow:hidden}
    .strip{display:flex; transition: transform .45s ease}
    .strip img{width:100%; height:320px; object-fit:cover; flex:0 0 100%}
    .controls{display:flex; gap:8px; padding:10px; align-items:center; justify-content:space-between; background:rgba(0,0,0,.06)}
    .pills{display:flex; gap:6px}
    .pill{width:8px; height:8px; border-radius:50%; background:rgba(255,255,255,.25)}
    html.light .pill{background:rgba(0,0,0,.2)}
    .pill.active{background:var(--accent)}
    .arrow{border:0; background:transparent; color:var(--fg); font-size:20px; cursor:pointer; padding:6px 8px}

    .credits{font-size:12px; color:var(--muted); text-align:center; margin-top:14px}

    .open .cover{transform: rotateY(-178deg)}
    .open .cover:after{content:""; position:absolute; inset:0; border-radius:22px; background:linear-gradient(90deg, rgba(0,0,0,.0), rgba(0,0,0,.35));}

    /* Confetti */
    .confetti{position:fixed; inset:0; pointer-events:none; overflow:hidden; z-index:9999}
    .piece{
      position:absolute; width:8px; height:12px; border-radius:2px; opacity:.95;
      animation: fall linear forwards;
    }
    @keyframes fall{
      to {transform: translateY(110vh) rotate(720deg)}
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="topbar">
      <h1>ðŸŽ‚ Tarjeta</h1>
      <button class="btn" id="toggleThemeBtn" title="Cambiar tema">ðŸŒ“ Tema</button>
    </div>

    <div class="scene">
      <div class="greeting-card" id="card">
        <div class="cover" id="cover" role="button" aria-label="Abrir tarjeta" tabindex="0">
          <div class="cover-content" style="text-align:center">
            <h2>Para Mel ðŸ’œ</h2>
            <p>TocÃ¡ para abrir</p>
          </div>
        </div>

        <div class="inside">
          <div class="message" aria-live="polite">
            <h3>Â¡Feliz cumple, Mel! ðŸŽ‰</h3>
            <p id="customText">
              Deseo que este aÃ±o te traiga proyectos lindos, risas hasta tarde y muchos mates compartidos.
              Gracias por estar siempre. ðŸ’« Te Quiero Mucho.
              <br>-Lopa
            </p>
          </div>
          <section class="gallery">
            <div class="viewport">
              <div class="strip" id="strip"></div>
            </div>
            <div class="controls">
              <button class="arrow" id="prev" aria-label="Anterior">â—€</button>
              <div class="pills" id="pills"></div>
              <button class="arrow" id="next" aria-label="Siguiente">â–¶</button>
            </div>
          </section>
          <div class="credits">Hecho con â™¥</div>
        </div>
      </div>
    </div>
  </div>

  <div class="confetti" id="confetti"></div>

  <script>
    const root = document.documentElement;
    const savedTheme = localStorage.getItem("theme");
    if(savedTheme === "light") root.classList.add("light");

    document.getElementById("toggleThemeBtn").onclick = () => {
      const isLight = root.classList.toggle("light");
      localStorage.setItem("theme", isLight ? "light" : "dark");
    };

    const card  = document.getElementById("card");
    const cover = document.getElementById("cover");
    const confettiLayer = document.getElementById("confetti");

    function launchConfetti(){
      const count = 80;
      confettiLayer.innerHTML = "";
      for(let i=0;i<count;i++){
        const el = document.createElement("div");
        el.className = "piece";
        const left = Math.random()*100;
        const delay = Math.random()*0.8;
        const dur = 1.6 + Math.random()*1.2;
        const w = 6 + Math.random()*8;
        const h = 8 + Math.random()*14;
        el.style.left = left + "vw";
        el.style.top = "-10vh";
        el.style.width = w+"px";
        el.style.height = h+"px";
        el.style.background = `hsl(${Math.random()*360}, 80%, 60%)`;
        el.style.animationDuration = dur+"s";
        el.style.animationDelay = delay+"s";
        confettiLayer.appendChild(el);
        setTimeout(()=> el.remove(), (delay+dur)*1000 + 500);
      }
    }

    function toggleCard(){
      const isOpen = card.classList.toggle("open");
      if(isOpen) launchConfetti();
    }
    cover.addEventListener("click", toggleCard);
    cover.addEventListener("keydown", (e)=>{ if(e.key==="Enter" || e.key===" "){ e.preventDefault(); toggleCard(); } });

    document.getElementById("year").textContent = new Date().getFullYear();

    // ===== GalerÃ­a =====
    const IMAGES = ["foto1.jpg","foto2.jpg","foto3.jpg"]; // tus archivos dentro de ./src/
    const IMAGE_PATH = "./src/";

    const strip = document.getElementById("strip");
    const pills = document.getElementById("pills");
    const btnPrev = document.getElementById("prev");
    const btnNext = document.getElementById("next");

    let idx = 0;

    function renderGallery(){
      strip.innerHTML = "";
      pills.innerHTML = "";
      IMAGES.forEach((name, i)=>{
        const img = document.createElement("img");
        img.src = IMAGE_PATH + name;
        img.alt = `Foto ${i+1}`;
        strip.appendChild(img);

        const dot = document.createElement("div");
        dot.className = "pill" + (i===idx ? " active" : "");
        dot.onclick = ()=> goTo(i);
        pills.appendChild(dot);
      });
      updatePos();
    }

    function updatePos(){
      strip.style.transform = `translateX(-${idx*100}%)`;
      [...pills.children].forEach((d, i)=> d.classList.toggle("active", i===idx));
    }

    function goTo(i){
      idx = (i + IMAGES.length) % IMAGES.length;
      updatePos();
    }

    btnPrev.onclick = ()=> goTo(idx-1);
    btnNext.onclick = ()=> goTo(idx+1);

    renderGallery();
  </script>
</body>
</html>
